<!DOCTYPE html>
<html>
    <head>
        <title>DADOS DA SORTE - Criar Conta</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, minimal-ui" />
        <link rel="stylesheet" href="css/reset.css" type="text/css">
        <link rel="stylesheet" href="css/main.css" type="text/css">
        <style>
            .auth-container{max-width:420px;margin:60px auto;padding:24px;background:#0c0e12;border-radius:8px;color:#fff}
            .auth-container h1{margin:0 0 16px;font-size:24px}
            .auth-container input{width:100%;padding:10px;margin:8px 0;background:#111827;border:1px solid #374151;color:#fff;border-radius:6px}
            .auth-container button{width:100%;padding:10px;margin:8px 0;background:#10b981;border:none;color:#062c22;border-radius:6px;font-weight:bold;cursor:pointer}
            .auth-container .muted{color:#9ca3af;text-align:center;margin-top:8px}
            .auth-container .error{color:#f87171;margin-top:6px}
        </style>
        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
        <script type="text/javascript" src="js/auth-config.js"></script>
        <script type="text/javascript" src="js/auth-client.js"></script>
    </head>
    <body>
        <div class="auth-container">
            <h1>Criar Conta</h1>
            <form id="register-form">
                <input id="email" type="email" placeholder="Email" required>
                <input id="password" type="password" placeholder="Senha" required>
                <button type="submit">Registrar</button>
            </form>
            
            <div id="error" class="error" style="display:none;"></div>
            <div class="muted">JÃ¡ tem conta? <a href="login.html">Entrar</a></div>
        </div>

        <script>
            (function(){
                function redirectIfLogged(){
                    sb.auth.getSession().then(function(res){
                        if(res.data && res.data.session){
                            window.location.href = "index.html";
                        }
                    });
                }
                redirectIfLogged();

                var form = document.getElementById('register-form');
                form.addEventListener('submit', function(e){
                    e.preventDefault();
                    var email = document.getElementById('email').value;
                    var password = document.getElementById('password').value;
                    sb.auth.signUp({ email: email, password: password })
                      .then(function(res){
                        if(res.error){
                            showError(res.error.message);
                        } else {
                            alert('Verifique seu email para confirmar a conta.');
                            window.location.href = "login.html";
                        }
                      });
                });

                function showError(msg){
                    var el = document.getElementById('error');
                    el.textContent = msg;
                    el.style.display = 'block';
                }
            })();
        </script>
    </body>
</html>

